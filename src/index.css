@tailwind base;
@tailwind components;
@tailwind utilities;

@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

/* PWA-specific styles */
@layer components {
  /* Install Button */
  .install-btn {
    @apply inline-flex items-center gap-2 px-4 py-2 text-sm font-medium;
    @apply bg-blue-600 hover:bg-blue-700 text-white rounded-lg;
    @apply transition-all duration-200 shadow-md hover:shadow-lg;
    @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2;
  }

  /* iOS Install Banner */
  .ios-install-banner {
    @apply fixed bottom-0 left-0 right-0 z-50;
    @apply bg-blue-600 text-white p-4;
    @apply transform translate-y-full transition-transform duration-300 ease-out;
    @apply shadow-xl border-t border-blue-500;
  }

  .ios-install-banner.show {
    @apply translate-y-0;
  }

  .banner-content {
    @apply flex justify-between items-center max-w-2xl mx-auto;
  }

  .banner-text strong {
    @apply block mb-1 font-semibold;
  }

  .banner-text p {
    @apply text-sm opacity-90 m-0;
  }

  .share-icon {
    @apply inline-block bg-white/20 px-2 py-1 rounded text-xs font-mono;
  }

  .banner-close {
    @apply bg-transparent border-none text-white text-xl cursor-pointer;
    @apply w-8 h-8 flex items-center justify-center rounded;
    @apply hover:bg-white/20 transition-colors duration-200;
    @apply focus:outline-none focus:ring-2 focus:ring-white/50;
  }

  /* Update Notification */
  .update-notification {
    @apply fixed top-0 left-0 right-0 z-50;
    @apply bg-amber-600 text-white p-4;
    @apply transform -translate-y-full transition-transform duration-300 ease-out;
    @apply shadow-xl border-b border-amber-500;
  }

  .update-notification.show {
    @apply translate-y-0;
  }

  .update-content {
    @apply flex justify-between items-center max-w-2xl mx-auto gap-4;
  }

  .update-btn {
    @apply bg-white/20 border border-white/30 text-white;
    @apply px-4 py-2 rounded-lg text-sm font-medium cursor-pointer;
    @apply hover:bg-white/30 transition-colors duration-200;
    @apply focus:outline-none focus:ring-2 focus:ring-white/50;
  }

  .dismiss-btn {
    @apply bg-transparent border-none text-white text-xl cursor-pointer;
    @apply w-8 h-8 flex items-center justify-center rounded;
    @apply hover:bg-white/20 transition-colors duration-200;
    @apply focus:outline-none focus:ring-2 focus:ring-white/50;
  }

  /* General Notifications */
  .notification {
    @apply fixed top-4 left-1/2 transform -translate-x-1/2 z-50;
    @apply bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700;
    @apply rounded-xl p-4 shadow-2xl min-w-60 text-center;
    @apply opacity-0 -translate-y-4 transition-all duration-300 ease-out;
  }

  .notification.show {
    @apply opacity-100 translate-y-0;
  }

  .notification.success {
    @apply border-green-200 dark:border-green-800;
    @apply bg-green-50 dark:bg-green-900/20;
    @apply text-green-800 dark:text-green-200;
  }

  /* Mobile safe area and navigation adjustments */
  .nav-modern {
    @apply glass;
    @apply border-t border-white/20 dark:border-white/10;
    padding-bottom: env(safe-area-inset-bottom, 0.5rem);
    min-height: 80px;
  }
  
  /* Game Screen Layout */
  .game-screen-container {
    @apply relative w-full;
    /* Ensure full height considering navigation */
    height: calc(100vh - 80px);
    min-height: calc(100vh - 80px);
  }

  .game-main-content {
    @apply h-full flex items-center justify-center p-4;
  }

  /* Input Panel Backdrop - positioned relative to viewport for full coverage */
  .game-input-backdrop {
    @apply fixed inset-0 bg-white dark:bg-gray-900 z-40;
    /* Fully opaque background */
    backdrop-filter: none;
  }

  /* New Input Panel Positioning - fixed to viewport center */
  .game-input-panel-new {
    @apply fixed z-50;
    @apply glass rounded-2xl;
    @apply border border-white/20 dark:border-white/10;
    @apply backdrop-blur-2xl;
    /* Center within the viewport */
    @apply left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2;
    @apply w-full max-w-md mx-4;
    max-height: 70vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    will-change: transform;
  }

  .game-input-content {
    @apply p-6 space-y-6;
  }

  /* Old game input panel - keeping for backward compatibility */
  .game-input-panel {
    @apply glass rounded-t-2xl p-6;
    @apply border-t border-white/20 dark:border-white/10;
    @apply backdrop-blur-2xl;
    bottom: calc(80px + env(safe-area-inset-bottom, 0px));
    max-height: 65vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    transform: translateZ(0);
    will-change: transform;
  }
  
  /* Main content mobile spacing */
  .main-content-mobile {
    padding-bottom: calc(100px + env(safe-area-inset-bottom, 0px));
  }

  /* Standalone mode adjustments */
  @media (display-mode: standalone) {
    .app-header {
      padding-top: env(safe-area-inset-top, 1rem);
    }
    
    .nav-modern {
      padding-bottom: env(safe-area-inset-bottom, 1rem);
    }
    
    /* Hide the install button when in standalone mode */
    .install-btn {
      @apply hidden;
    }
    
    /* Adjust scrolling for iOS Safari */
    body {
      -webkit-overflow-scrolling: touch;
    }
  }

  /* Loading states for PWA */
  .pwa-loading {
    @apply animate-pulse bg-gray-200 dark:bg-gray-700 rounded;
  }

  /* Accessibility improvements */
  @media (prefers-reduced-motion: reduce) {
    .notification,
    .ios-install-banner,
    .update-notification {
      @apply transition-none;
    }
  }
}

/* Reset and base styles */
* {
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  padding: 0;
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 50%, #cbd5e1 100%);
  min-height: 100vh;
  color: #1e293b;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.dark body {
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
  color: #f1f5f9;
}

@layer components {
  /* Glass morphism effects */
  .glass {
    @apply backdrop-blur-xl bg-white/20 dark:bg-white/5;
    @apply border border-white/20 dark:border-white/10;
    @apply shadow-2xl shadow-black/10 dark:shadow-black/30;
  }
  
  .glass-card {
    @apply glass rounded-2xl p-6;
  }
  
  /* Modern buttons */
  .btn-modern {
    @apply relative overflow-hidden rounded-xl px-8 py-4 font-semibold transition-all duration-300;
    @apply shadow-lg hover:shadow-xl;
    will-change: transform;
    backface-visibility: hidden;
  }
  
  .btn-primary-modern {
    @apply btn-modern;
    @apply bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700;
    @apply text-white;
    @apply before:absolute before:inset-0 before:bg-gradient-to-r before:from-white/20 before:to-transparent before:opacity-0 hover:before:opacity-100 before:transition-opacity;
  }
  
  .btn-secondary-modern {
    @apply btn-modern;
    @apply glass text-slate-700 dark:text-slate-200;
    @apply hover:bg-white/30 dark:hover:bg-white/10;
  }
  
  /* Number display with glassmorphism */
  .number-display {
    @apply glass-card text-center;
    @apply w-64 h-64 flex items-center justify-center;
    @apply text-6xl font-bold;
    @apply bg-gradient-to-br from-blue-600 to-indigo-600 bg-clip-text text-transparent;
    @apply animate-float;
  }
  
  /* Navigation styling moved to mobile adjustments section above */
  
  /* Settings sections */
  .settings-section {
    @apply glass-card space-y-6;
  }
  
  /* Game input panel styling moved to mobile adjustments section above */
  
  /* Number pad styling */
  .number-key {
    @apply glass rounded-xl;
    @apply w-16 h-16 flex items-center justify-center;
    @apply text-xl font-semibold;
    @apply text-slate-700 dark:text-slate-200;
    @apply transition-all duration-200;
    @apply hover:bg-white/30 dark:hover:bg-white/10;
    @apply active:scale-95 active:bg-white/40 dark:active:bg-white/20;
    will-change: transform;
    backface-visibility: hidden;
    /* Better mobile interaction */
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
    user-select: none;
  }
  
  .clear-key {
    @apply number-key;
    @apply bg-gradient-to-r from-red-500 to-pink-500 text-white;
    @apply hover:from-red-600 hover:to-pink-600;
  }
  
  .submit-key {
    @apply number-key;
    @apply bg-gradient-to-r from-green-500 to-emerald-500 text-white;
    @apply hover:from-green-600 hover:to-emerald-600;
  }
  
  /* Header styling */
  .header-modern {
    @apply glass border-b border-white/20 dark:border-white/10;
    @apply backdrop-blur-xl;
  }
  
  /* Screen transitions */
  .screen-modern {
    @apply flex-1 flex items-center justify-center p-4;
    /* Account for header and navigation heights */
    min-height: calc(100vh - 140px); /* ~60px header + ~80px nav */
    padding-top: 1rem;
    padding-bottom: calc(100px + env(safe-area-inset-bottom, 0px));
  }
  
  /* Results styling */
  .result-card {
    @apply glass-card text-center space-y-4;
  }
  
  .score-display {
    @apply text-4xl font-bold;
    @apply bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent;
  }
  
  /* Range slider styling */
  .slider-thumb {
    @apply bg-slate-200 dark:bg-slate-700;
  }
  
  .slider-thumb::-webkit-slider-thumb {
    @apply w-5 h-5 rounded-full appearance-none cursor-pointer;
    @apply bg-blue-600 hover:bg-blue-700;
    @apply shadow-lg shadow-blue-600/30;
    @apply transition-all duration-200;
  }
  
  .slider-thumb::-moz-range-thumb {
    @apply w-5 h-5 rounded-full border-0 cursor-pointer;
    @apply bg-blue-600 hover:bg-blue-700;
    @apply shadow-lg shadow-blue-600/30;
    @apply transition-all duration-200;
  }

  /* Dark mode utilities */
  .dark-toggle {
    @apply glass rounded-full p-2;
    @apply transition-all duration-300;
    will-change: transform;
    backface-visibility: hidden;
  }
}

@layer utilities {
  /* Custom gradient backgrounds */
  .bg-gradient-mesh {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }
  
  .bg-gradient-mesh-dark {
    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
  }
  
  /* Text gradients */
  .text-gradient {
    @apply bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent;
  }
  
  .text-gradient-success {
    @apply bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent;
  }
  
  .text-gradient-error {
    @apply bg-gradient-to-r from-red-600 to-pink-600 bg-clip-text text-transparent;
  }
  
  /* Animation utilities */
  .animate-in {
    @apply animate-scale-in;
  }
  
  .animate-float {
    animation: float 6s ease-in-out infinite;
    will-change: transform;
    backface-visibility: hidden;
    perspective: 1000px;
    transform-style: preserve-3d;
  }
  
  /* Glow effects */
  .glow-blue {
    box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
  }
  
  .glow-green {
    box-shadow: 0 0 20px rgba(34, 197, 94, 0.3);
  }
  
  .glow-red {
    box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
  }

  /* Achievement Popup */
  .achievement-popup {
    @apply fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2;
    @apply glass-card z-50 max-w-md w-full mx-4;
    @apply opacity-0 scale-75 transition-all duration-300 ease-out;
  }

  .achievement-popup.show {
    @apply opacity-100 scale-100;
  }

  .achievement-content {
    @apply flex items-center space-x-4;
  }

  .achievement-popup .achievement-icon {
    @apply text-4xl animate-bounce;
  }

  .achievement-text h4 {
    @apply text-sm font-medium text-slate-600 dark:text-slate-400 mb-1;
  }

  .achievement-text h3 {
    @apply text-xl font-bold text-gradient mb-2;
  }

  .achievement-text p {
    @apply text-sm text-slate-600 dark:text-slate-300;
  }
}

/* Custom animations */
@keyframes float {
  0%, 100% {
    transform: translate3d(0, 0, 0) rotateZ(0deg);
  }
  25% {
    transform: translate3d(0, -5px, 0) rotateZ(0.5deg);
  }
  50% {
    transform: translate3d(0, -10px, 0) rotateZ(0deg);
  }
  75% {
    transform: translate3d(0, -5px, 0) rotateZ(-0.5deg);
  }
}

/* Mobile optimizations */
@media (max-width: 640px) {
  .number-display {
    @apply w-48 h-48 text-4xl;
  }
  
  .btn-modern {
    @apply px-6 py-3 text-sm;
  }
  
  .glass-card {
    @apply p-4;
  }
  
  /* Simple mobile navigation spacing */
  .nav-modern {
    padding-bottom: env(safe-area-inset-bottom, 0.5rem);
  }

  /* Game screen mobile adjustments */
  .game-screen-container {
    /* Adjust for mobile viewport height and navigation */
    height: calc(100vh - 80px - env(safe-area-inset-bottom, 0px));
    min-height: calc(100vh - 80px - env(safe-area-inset-bottom, 0px));
  }
  
  /* Mobile bottom padding to avoid navigation overlap */
  .pb-safe {
    padding-bottom: calc(100px + env(safe-area-inset-bottom, 0px));
  }

  /* Mobile-specific input panel positioning */
  .game-input-panel-new {
    /* Keep centered positioning but adjust for mobile */
    max-height: 60vh;
    @apply w-11/12 max-w-sm;
    /* Ensure proper centering on mobile */
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
  }

  .game-input-content {
    @apply p-4 space-y-4;
  }
  
  /* Input panel positioned above navigation - old class */
  .game-input-panel {
    position: fixed;
    bottom: calc(80px + env(safe-area-inset-bottom, 0px));
    left: 0;
    right: 0;
    max-height: 60vh;
    overflow-y: auto;
  }
  
  /* Number pad mobile optimization */
  .number-key {
    @apply w-14 h-14 text-lg;
    min-width: 44px;
    min-height: 44px;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }
}

/* Reduce motion for accessibility */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}